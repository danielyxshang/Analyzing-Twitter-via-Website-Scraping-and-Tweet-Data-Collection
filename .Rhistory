knitr::opts_chunk$set(echo = TRUE)
################################################### Data cleaning and preparation ####################################################
# Load the data
tweet = read.csv('C:/Users/34527/Desktop/vaccine_tweet.csv')
# Take a glance at the data
summary(tweet)
head(tweet, 20)
# Drop the column that is not necessary
to_drop = c('UserName')
tweet = tweet[,colnames(tweet)!= to_drop]
# Check if there is any missing data
sum(tweet[,'Text'] == '')
sum(is.null(tweet[,'Text']))
sum(is.na(tweet[,'Text']))
################################################### Data cleaning and preparation ####################################################
# Load the data
tweet = read.csv('C:/Users/34527/Desktop/vaccine_tweet.csv')
# Take a glance at the data
summary(tweet)
# Drop the column that is not necessary
to_drop = c('UserName')
tweet = tweet[,colnames(tweet)!= to_drop]
# Check if there is any missing data
sum(tweet[,'Text'] == '')
sum(is.null(tweet[,'Text']))
sum(is.na(tweet[,'Text']))
######################################################### Data visualization #########################################################
# Unnest the tokens in each Tweet and group them by Timestamp column
tidy_tweet = tweet %>% select(Timestamp, Text) %>% unnest_tokens('word', Text)
knitr::opts_chunk$set(echo = TRUE)
ggplot(data = data, aes(x = factor(Response), fill = Response)) + geom_bar(color = 'white', show.legend = FALSE) + labs(title = 'Bar chart of customer response') + theme_hc()
unlink('Tweet analysis_cache', recursive = TRUE)
install.packages("latexpdf")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(ggthemes)
library(dplyr)
data = read.csv('dataset.csv')
# Check if there is any missing data in the data set
for (i in 1:ncol(data)) {
print(paste(colnames(data)[i], ':', sum(is.null(data[, i]))))
print(paste(colnames(data)[i], ':', sum(data[, i] == 'NA')))
print(paste(colnames(data)[i], ':', sum(data[, i] == 'N/A')))
print(paste(colnames(data)[i], ':', sum(data[, i] == '')))
}
# Transform categorical variables to dummy variables for easier analysis and better model performance
data[data[, 'Vehicle_Damage'] == 'Yes', 'Vehicle_Damage'] = 1
data[data[, 'Vehicle_Damage'] == 'No', 'Vehicle_Damage'] = 0
data[data[, 'Vehicle_Age'] == '< 1 Year', 'Vehicle_Age'] = 0
data[data[, 'Vehicle_Age'] == '1-2 Year', 'Vehicle_Age'] = 1
data[data[, 'Vehicle_Age'] == '> 2 Years', 'Vehicle_Age'] = 2
data[data[, 'Gender'] == 'Female', 'Gender'] = 0
data[data[, 'Gender'] == 'Male', 'Gender'] = 1
# A histogram showing the distribution of customer age
ggplot(data = data, aes(Age)) +
geom_histogram(aes(y=..density..), fill="dodgerblue4", color = 'white', alpha = 0.5, bins = 30) +
geom_density() +
labs(title = 'Histogram of Age') +
theme(plot.title = element_text(hjust = 0.5)) +
labs(title = 'Histogram of Age') +
theme_hc()
# A histogram showing the distribution of annual premium customers currently pay
ggplot(data = data, aes(Annual_Premium)) +
geom_histogram(aes(y=..density..), fill="dodgerblue4", color = 'gray', alpha = 0.5, bins = 50) +
geom_density(adjust = 3) +
labs(title = 'Histogram of Annual_Premium (in thousand)') +
theme(plot.title = element_text(hjust = 0.5)) +
theme_hc() +
scale_x_continuous(labels = function(x){x/10^3})
# A histogram showing the distribution of customer vintage (the number of days they have been associated with the company)
ggplot(data = data, aes(Vintage)) +
geom_histogram(aes(y=..density..), fill="dodgerblue4", color = 'white', alpha = 0.5, bins = 30) +
geom_density() +
labs(title = 'Histogram of Vintage') +
theme(plot.title = element_text(hjust = 0.5)) +
theme_hc()
# A bar chart showing the number of customers in each gender group
ggplot(data = data, aes(Gender, fill = Gender)) +
geom_bar(width = 0.5, alpha = 0.5, color = 'white', show.legend = FALSE) +
labs(title = 'Bar chart of Gender') +
theme(plot.title = element_text(hjust = 0.5)) +
theme_hc()
# A bar chart showing the number of customers with and without a driver's license
ggplot(data = data, aes(factor(Driving_License), fill = factor(Driving_License))) + geom_bar(width = 0.5, alpha = 0.5, show.legend = FALSE) +
labs(title = 'Bar chart of Driving_License (in thousand)', x = 'Driving_License') +
theme(plot.title = element_text(hjust = 0.5), legend.position = 'none') +
scale_y_continuous(labels = function(y) {y/10^3}) +
theme_hc()
# A bar chart showing the number of customers within each region code
ggplot(data = data, aes(factor(Region_Code), fill = factor(Region_Code))) + geom_bar(alpha = 0.5, color = 'white', show.legend = FALSE) + labs(title = 'Bar chart of Region_Code', x = 'Region_Code') + theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.3)) + theme_hc()
# A bar chart showing the number of customers who are and are not previously insured
ggplot(data = data, aes(factor(Previously_Insured), fill = factor(Previously_Insured))) + geom_bar(width = 0.5, alpha = 0.5, color = 'white', show.legend = FALSE) + labs(title = 'Bar chart of Previously_Insured', x = 'Previously_Insured') + theme(plot.title = element_text(hjust = 0.5)) + theme_hc()
# A bar chart showing the count of customers with a vehicle that falls into each of the three vehicle age groups
ggplot(data = data, aes(factor(Vehicle_Age, ordered = TRUE, levels = c('0', '1', '2')),fill = factor(Vehicle_Age))) + geom_bar(width = 0.5, alpha = 0.5, color = 'white', show.legend = FALSE) + labs(title = 'Bar chart of Vehicle_Age', x = 'Vehicle_Age') + theme(plot.title = element_text(hjust = 0.5)) + theme_hc()
# A bar chart showing the number of customers with and without their vehicle been damaged
ggplot(data = data, aes(Vehicle_Damage, fill = Vehicle_Damage)) + geom_bar(width = 0.5, alpha = 0.5, color = 'white', show.legend = FALSE) + labs(title = 'Bar chart of Vehicle_Damage') + theme(plot.title = element_text(hjust = 0.5)) + theme_hc()
# A bar chart showing the number of customers within each policy sales channel
data %>% ggplot(aes(x = reorder(factor(Policy_Sales_Channel), Policy_Sales_Channel, function(x) -length(x)), fill = factor(Policy_Sales_Channel))) + geom_bar(alpha = 0.5, color = 'white', show.legend = FALSE) + labs(title = 'Bar chart of Policy_Sales_Channel (High to low in thousand)', x = 'Policy_Sales_Channel') + theme(axis.text.x = element_text(hjust = 1, angle = 90, vjust = 0.3, size = 7.5)) + scale_y_continuous(labels = function(y) {y/10^3}) + theme_hc()
ggplot(data = data, aes(x = factor(Response), fill = Response)) + geom_bar(color = 'white', show.legend = FALSE) + labs(title = 'Bar chart of customer response') + theme_hc()
ggplot(data = data, aes(Response, fill = Response)) +
geom_bar(width = 0.5, alpha = 0.5, color = 'white', show.legend = FALSE) +
labs(title = 'Bar chart of customer response') +
theme(plot.title = element_text(hjust = 0.5)) +
theme_hc()
ggplot(data = data, aes(factor(Response), fill = Response)) +
geom_bar(width = 0.5, alpha = 0.5, color = 'white', show.legend = FALSE) +
labs(title = 'Bar chart of customer response') +
theme(plot.title = element_text(hjust = 0.5)) +
theme_hc()
ggplot(data = data, aes(factor(Response), fill = factor(Response))) +
geom_bar(width = 0.5, alpha = 0.5, color = 'white', show.legend = FALSE) +
labs(title = 'Bar chart of customer response') +
theme(plot.title = element_text(hjust = 0.5)) +
theme_hc()
ggplot(data = data, aes(factor(Response), fill = factor(Response))) +
geom_bar(width = 0.5, alpha = 0.5, color = 'white', show.legend = FALSE) +
labs(title = 'Bar chart of customer response', x = 'Response') +
theme(plot.title = element_text(hjust = 0.5)) +
theme_hc()
ggplot(data = data, aes(factor(Response),fill = Previously_Insured)) +
geom_bar(position='fill',color='black') +
scale_y_continuous(labels=percent) +
theme(legend.title = element_blank()) +
labs(x='Customer response',title='Response by previous insurances') +
scale_fill_manual(values= c('#3C3838','#338076')) +
theme_classic()
ggplot(data = data, aes(factor(Response),fill = Previously_Insured)) +
geom_bar(position='fill',color='black') +
scale_y_continuous(labels = percent) +
theme(legend.title = element_blank()) +
labs(x='Customer response',title='Response by previous insurances') +
scale_fill_manual(values= c('#3C3838','#338076')) +
theme_classic()
ggplot(data = data, aes(factor(Response),fill = Previously_Insured)) +
geom_bar(position='fill',color='black') +
scale_y_continuous(labels = 'percent') +
theme(legend.title = element_blank()) +
labs(x='Customer response',title='Response by previous insurances') +
scale_fill_manual(values= c('#3C3838','#338076')) +
theme_classic()
ggplot(data = data, aes(factor(Response),fill = Previously_Insured)) +
geom_bar(position='fill',color='black') +
theme(legend.title = element_blank()) +
labs(x='Customer response',title='Response by previous insurances') +
scale_fill_manual(values= c('#3C3838','#338076')) +
theme_classic()
a2 <- train %>% mutate(c_resp=factor(Response),Insured=factor(Previously_Insured)) %>%
ggplot(aes(c_resp,fill=Insured)) +
geom_bar(position='fill',color='black') +
scale_y_continuous(labels=percent) +
theme(legend.title = element_blank()) +
labs(x='Customer response',title='Response by previous insurances') +
scale_fill_manual(values= c('#3C3838','#338076')) +
theme_classic()
a2 <- data %>% mutate(c_resp=factor(Response),Insured=factor(Previously_Insured)) %>%
ggplot(aes(c_resp,fill=Insured)) +
geom_bar(position='fill',color='black') +
scale_y_continuous(labels=percent) +
theme(legend.title = element_blank()) +
labs(x='Customer response',title='Response by previous insurances') +
scale_fill_manual(values= c('#3C3838','#338076')) +
theme_classic()
a2 <- data %>% mutate(c_resp=factor(Response),Insured=factor(Previously_Insured)) %>%
ggplot(aes(c_resp,fill=Insured)) +
geom_bar(position='fill',color='black') +
scale_y_continuous(labels='percent') +
theme(legend.title = element_blank()) +
labs(x='Customer response',title='Response by previous insurances') +
scale_fill_manual(values= c('#3C3838','#338076')) +
theme_classic()
data %>% mutate(c_resp=factor(Response),Insured=factor(Previously_Insured)) %>%
ggplot(aes(c_resp,fill=Insured)) +
geom_bar(position='fill',color='black') +
scale_y_continuous(labels='percent') +
theme(legend.title = element_blank()) +
labs(x='Customer response',title='Response by previous insurances') +
scale_fill_manual(values= c('#3C3838','#338076')) +
theme_classic()
a2 <- data %>% mutate(c_resp=factor(Response),Insured=factor(Previously_Insured)) %>%
ggplot(aes(c_resp,fill=Insured)) +
geom_bar(position='fill',color='black') +
scale_y_continuous(labels='percent') +
theme(legend.title = element_blank()) +
labs(x='Customer response',title='Response by previous insurances') +
scale_fill_manual(values= c('#3C3838','#338076')) +
theme_classic()
show(a2)
library(grid)
library(gridExtra)
a2 <- data %>% mutate(c_resp=factor(Response),Insured=factor(Previously_Insured)) %>%
ggplot(aes(c_resp,fill=Insured)) +
geom_bar(position='fill',color='black') +
scale_y_continuous(labels='percent') +
theme(legend.title = element_blank()) +
labs(x='Customer response',title='Response by previous insurances') +
scale_fill_manual(values= c('#3C3838','#338076')) +
theme_classic()
a3 <- train %>% mutate(c_resp=factor(Response)) %>%
ggplot(aes(c_resp,fill=Vehicle_Damage)) +
geom_bar(color="black",position='fill') +
scale_y_continuous(labels=percent) +
labs(x='Customer response',title='Response by vehicle history') +
scale_fill_manual(values= c('#3C3838','#338076'),name="Damaged?") +
theme_classic()
library(grid)
library(gridExtra)
a2 <- data %>% mutate(c_resp=factor(Response),Insured=factor(Previously_Insured)) %>%
ggplot(aes(c_resp,fill=Insured)) +
geom_bar(position='fill',color='black') +
scale_y_continuous(labels='percent') +
theme(legend.title = element_blank()) +
labs(x='Customer response',title='Response by previous insurances') +
scale_fill_manual(values= c('#3C3838','#338076')) +
theme_classic()
a3 <- data %>% mutate(c_resp=factor(Response)) %>%
ggplot(aes(c_resp,fill=Vehicle_Damage)) +
geom_bar(color="black",position='fill') +
scale_y_continuous(labels=percent) +
labs(x='Customer response',title='Response by vehicle history') +
scale_fill_manual(values= c('#3C3838','#338076'),name="Damaged?") +
theme_classic()
library(grid)
library(gridExtra)
a2 <- data %>% mutate(c_resp=factor(Response),Insured=factor(Previously_Insured)) %>%
ggplot(aes(c_resp,fill=Insured)) +
geom_bar(position='fill',color='black') +
scale_y_continuous(labels='percent') +
theme(legend.title = element_blank()) +
labs(x='Customer response',title='Response by previous insurances') +
scale_fill_manual(values= c('#3C3838','#338076')) +
theme_classic()
a3 <- data %>% mutate(c_resp=factor(Response)) %>%
ggplot(aes(c_resp,fill=Vehicle_Damage)) +
geom_bar(color="black",position='fill') +
scale_y_continuous(labels='percent') +
labs(x='Customer response',title='Response by vehicle history') +
scale_fill_manual(values= c('#3C3838','#338076'),name="Damaged?") +
theme_classic()
a4 <- data %>% mutate(c_resp=factor(Response)) %>%
ggplot(aes(c_resp,fill=Gender)) +
geom_bar(color="black",position='fill') +
scale_y_continuous(labels='percent') +
labs(x='Customer response',title='Response by gender') +
scale_fill_manual(values= c('#3C3838','#338076'),name="Gender") +
theme_classic()
a5 <- data %>% mutate(c_resp=factor(Response)) %>%
ggplot(aes(c_resp,fill=Vehicle_Age)) +
geom_bar(color="black",position='fill') +
scale_y_continuous(labels='percent') +
labs(x='Customer response',title='Response by vehicle age') +
scale_fill_manual(values= c('#3C3838','#338076',"#333B80"),name='Vehicle age') +
theme_classic()
grid.arrange(a2,a3,a4,a5)
View(a2)
data %>%
ggplot(aes(factor(Response),fill=factor(Previously_Insured))) +
geom_bar(position='fill',color='black') +
scale_y_continuous(labels='percent') +
theme(legend.title = element_blank()) +
labs(x='Customer response',title='Response by previous insurances') +
scale_fill_manual(values= c('#3C3838','#338076')) +
theme_classic()
# https://www.kaggle.com/virosky/insurance-interest-prediction-test-auc-0-93
rlang::last_error()
data %>%
ggplot(aes(factor(Response),fill=factor(Previously_Insured))) +
geom_bar(position='fill',color='black') +
scale_y_continuous(labels= c('0%', '25%', '50%', '75%', '100%'), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
theme(legend.title = element_blank()) +
labs(x='Customer response',title='Response by previous insurances') +
scale_fill_manual(values= c('#3C3838','#338076')) +
theme_classic()
data %>%
ggplot(aes(factor(Response),fill=factor(Previously_Insured))) +
geom_bar(position='fill',color='black') +
scale_y_continuous(labels= c('0%', '25%', '50%', '75%', '100%'), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
theme(legend.title = element_blank()) +
labs(x='Customer response',title='Response by previous insurances') +
scale_fill_manual(values= c('#3C3838','#338076')) +
theme(plot.title = element_text(hjust = 0.5)) +
theme_classic()
data %>%
ggplot(aes(factor(Response),fill=factor(Previously_Insured))) +
geom_bar(position='fill',color='black') +
scale_y_continuous(labels= c('0%', '25%', '50%', '75%', '100%'), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
theme(legend.title = element_blank()) +
labs(x='Customer response',title='Response by previous insurances') +
scale_fill_manual(values= c('#3C3838','#338076')) +
theme(plot.title = element_text(hjust = 1)) +
theme_classic()
data %>%
ggplot(aes(factor(Response),fill=factor(Previously_Insured))) +
geom_bar(position='fill',color='black') +
scale_y_continuous(labels= c('0%', '25%', '50%', '75%', '100%'), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
theme(legend.title = element_blank(), plot.title = element_text(hjust = 1)) +
labs(x='Customer response',title='Response by previous insurances') +
scale_fill_manual(values= c('#3C3838','#338076')) +
theme_classic()
data %>%
ggplot(aes(factor(Response),fill=factor(Previously_Insured))) +
geom_bar(position='fill',color='black') +
scale_y_continuous(labels= c('0%', '25%', '50%', '75%', '100%'), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
labs(x='Customer response',title='Response by previous insurances') +
theme(legend.title = element_blank(), plot.title = element_text(hjust = 1)) +
scale_fill_manual(values= c('#3C3838','#338076')) +
theme_classic()
data %>%
ggplot(aes(factor(Response),fill=factor(Previously_Insured))) +
geom_bar(position='fill',color='black') +
scale_y_continuous(labels= c('0%', '25%', '50%', '75%', '100%'), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
labs(x='Customer response',title='Response by previous insurances') +
theme(legend.title = element_blank(), plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(values= c('#3C3838','#338076')) +
theme_classic()
data %>%
ggplot(aes(factor(Response),fill=factor(Previously_Insured))) +
geom_bar(position='fill',color='black') +
scale_y_continuous(labels= c('0%', '25%', '50%', '75%', '100%'), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
labs(x='Customer response', title = 'Response by previous insurances') +
theme(legend.title = element_blank(), plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(values= c('#3C3838','#338076')) +
theme_classic()
ggplot(data = data, aes(factor(Response), fill=factor(Previously_Insured))) +
geom_bar(position='fill',color='black') +
scale_y_continuous(labels= c('0%', '25%', '50%', '75%', '100%'), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
labs(x='Customer response', title = 'Response by previous insurances') +
theme(legend.title = element_blank(), plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(values= c('#3C3832','#338075')) +
theme_classic()
ggplot(data = data, aes(factor(Response), fill=factor(Previously_Insured))) +
geom_bar(position='fill',color='black') +
scale_y_continuous(labels= c('0%', '25%', '50%', '75%', '100%'), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
labs(x='Customer response', title = 'Response by previous insurances') +
theme(legend.title = element_blank(), plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(values= c('#3C3332','#335075')) +
theme_classic()
ggplot(data = data, aes(factor(Response), fill=factor(Previously_Insured))) +
geom_bar(position='fill',color='black') +
scale_y_continuous(labels= c('0%', '25%', '50%', '75%', '100%'), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
labs(x='Customer response', title = 'Response by previous insurances') +
theme(legend.title = element_blank(), plot.title = element_text(hjust = 0.5)) +
theme_classic()
ggplot(data = data, aes(factor(Response), fill = factor(Previously_Insured))) +
geom_bar(position = 'fill', color = 'white') +
scale_y_continuous(labels= c('0%', '25%', '50%', '75%', '100%'), breaks = c(0, 0.25, 0.5, 0.75, 1)) +
labs(x='Customer response', title = 'Response by previous insurances') +
theme(legend.title = element_blank(), plot.title = element_text(hjust = 0.5)) +
theme_classic()
ggplot(data = data, aes(factor(Response), fill = factor(Previously_Insured))) +
geom_bar(position = 'fill', color = 'white') +
scale_y_continuous(labels= scales::percent) +
labs(x='Customer response', title = 'Response by previous insurances') +
theme(legend.title = element_blank(), plot.title = element_text(hjust = 0.5)) +
theme_classic()
ggplot(data = data, aes(factor(Response), fill = factor(Previously_Insured))) +
geom_bar(position = 'fill', color = 'white') +
scale_y_continuous(labels = percent) +
labs(x='Customer response', title = 'Response by previous insurances') +
theme(legend.title = element_blank(), plot.title = element_text(hjust = 0.5)) +
theme_classic()
ggplot(data = data, aes(factor(Response), fill = factor(Previously_Insured))) +
geom_bar(position = 'fill', color = 'white') +
scale_y_continuous(labels = 'percent') +
labs(x='Customer response', title = 'Response by previous insurances') +
theme(legend.title = element_blank(), plot.title = element_text(hjust = 0.5)) +
theme_classic()
ggplot(data = data, aes(factor(Response), fill = factor(Previously_Insured))) +
geom_bar(position = 'fill', color = 'white') +
scale_y_continuous(labels = scales::percent) +
labs(x='Customer response', title = 'Response by previous insurances') +
theme(legend.title = element_blank(), plot.title = element_text(hjust = 0.5)) +
theme_classic()
ggplot(data = data, aes(factor(Response), fill = factor(Previously_Insured))) +
geom_bar(position = 'fill', color = 'white') +
scale_y_continuous(labels = scales::percent) +
labs(x='Customer response', title = 'Customer response combined with previously insured') +
theme(legend.title = element_blank(), plot.title = element_text(hjust = 0.5)) +
theme_classic()
ggplot(data = data, aes(factor(Response), fill = factor(Previously_Insured))) +
geom_bar(position = 'fill', color = 'white') +
scale_y_continuous(labels = scales::percent) +
labs(x='Customer response', title = 'Customer response combined with previously insured') +
theme(plot.title = element_text(hjust = 0.5)) +
theme_classic()
ggplot(data = data, aes(factor(Response), fill = factor(Previously_Insured))) +
geom_bar(position = 'fill', color = 'white') +
scale_y_continuous(labels = scales::percent) +
labs(x='Customer response', title = 'Customer response combined with previously insured') +
theme(legend.title = element_blank(), plot.title = element_text(hjust = 0.5)) +
theme_classic()
ggplot(data = data, aes(factor(Response), fill = factor(Previously_Insured))) +
geom_bar(position = 'fill', color = 'white') +
scale_y_continuous(labels = scales::percent) +
labs(x='Customer response', title = 'Customer response combined with previously insured') +
theme(plot.title = element_text(hjust = 0.5)) +
theme_classic()
ggplot(data = data, aes(factor(Response), fill = factor(Previously_Insured))) +
geom_bar(position = 'fill', color = 'white') +
scale_y_continuous(labels = scales::percent) +
labs(x='Customer response', title = 'Customer response combined with previously insured') +
theme_hc()
ggplot(data = data, aes(factor(Response), fill = factor(Previously_Insured))) +
geom_bar(width = 0.5, alpha = 0.5, position = 'fill', color = 'white') +
scale_y_continuous(labels = scales::percent) +
labs(x='Customer response', title = 'Customer response combined with previously insured') +
theme_hc()
ggplot(data = data, aes(factor(Response), fill = factor(Previously_Insured))) +
geom_bar(width = 0.5, alpha = 0.8, position = 'fill', color = 'white') +
scale_y_continuous(labels = scales::percent) +
labs(x='Customer response', title = 'Customer response combined with previously insured') +
theme_hc()
ggplot(data = data, aes(factor(Response), fill = factor(Previously_Insured))) +
geom_bar(width = 0.5, alpha = 0.8, position = 'fill', color = 'white') +
scale_y_continuous(labels = scales::percent) +
labs(x='Customer response', title = 'Customer response combined with previously insured') +
theme(plot.title = element_text(hjust = 0.5)) +
theme_hc()
ggplot(data = data, aes(factor(Response), fill = factor(Previously_Insured))) +
geom_bar(width = 0.5, alpha = 0.8, color = 'white') +
scale_y_continuous(labels = scales::percent) +
labs(x='Customer response', title = 'Customer response combined with previously insured') +
theme(plot.title = element_text(hjust = 0.5)) +
theme_hc()
ggplot(data = data, aes(factor(Response), fill = factor(Previously_Insured))) +
geom_bar(width = 0.5, alpha = 0.8, position = 'fill', color = 'white') +
scale_y_continuous(labels = scales::percent) +
labs(x='Customer response', title = 'Customer response combined with previously insured') +
theme(plot.title = element_text(hjust = 0.5)) +
theme_hc()
ggplot(data = data, aes(factor(Response), fill = factor(Previously_Insured))) +
geom_bar(width = 0.5, alpha = 0.8, position = 'fill', color = 'white') +
scale_y_continuous(labels = scales::percent) +
labs(x='Customer response', title = 'Customer response combined with previously insured', color = 'Previously_Insured') +
theme(plot.title = element_text(hjust = 0.5)) +
theme_hc()
ggplot(data = data, aes(factor(Response), fill = factor(Previously_Insured))) +
geom_bar(width = 0.5, alpha = 0.8, position = 'fill', color = 'white') +
scale_y_continuous(labels = scales::percent) +
labs(x='Customer response', title = 'Customer response combined with previously insured', color = 'Previously_Insured') +
theme(plot.title = element_text(hjust = 0.5)) +
theme_hc() +
scale_color_discrete(name = "Previously_Insured")
ggplot(data = data, aes(factor(Response), fill = Previously_Insured)) +
geom_bar(width = 0.5, alpha = 0.8, position = 'fill', color = 'white') +
scale_y_continuous(labels = scales::percent) +
labs(x='Customer response', title = 'Customer response combined with previously insured') +
theme(plot.title = element_text(hjust = 0.5)) +
theme_hc()
ggplot(data = data, aes(factor(Response), fill = factor(Previously_Insured))) +
geom_bar(width = 0.5, alpha = 0.8, position = 'fill', color = 'white') +
scale_y_continuous(labels = scales::percent) +
labs(x='Customer response', title = 'Customer response combined with previously insured') +
theme(plot.title = element_text(hjust = 0.5)) +
theme_hc()
ggplot(data, aes(Response, fill = factor(Gender))) +
geom_bar(width = 0.5, alpha = 0.8, position = 'fill', color = 'white') +
scale_y_continuous(labels = scales::percent) +
labs(x = 'Customer response', title = 'Customer response combined with gender') +
theme(plot.title = element_text(hjust = 0.5)) +
theme_hc()
ggplot(data, aes(factor(Response), fill = factor(Gender))) +
geom_bar(width = 0.5, alpha = 0.8, position = 'fill', color = 'white') +
scale_y_continuous(labels = scales::percent) +
labs(x = 'Customer response', title = 'Customer response combined with gender') +
theme(plot.title = element_text(hjust = 0.5)) +
theme_hc()
